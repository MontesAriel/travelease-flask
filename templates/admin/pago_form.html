{% extends "admin/admin_base.html" %}
{% block content %}

<h2>{{ "Editar Pago" if pago else "Nuevo Pago" }}</h2>

<form action="{{ url_for('admin_pago_update', pago_id=pago.pago_id) if pago else url_for('admin_pago_create') }}"
      method="POST">

    <!-- Reserva -->
    <label>Reserva</label>
    <select name="reserva_id" class="form-select" required>
        {% for r in reservas %}
            <option value="{{ r.reserva_id }}"
                {% if pago and pago.reserva_id == r.reserva_id %}selected{% endif %}>
                Reserva #{{ r.reserva_id }} - Usuario: {{ r.usuario_id }} - Total: ${{ r.total }}
            </option>
        {% endfor %}
    </select>

    <!-- Método -->
    <label class="mt-3">Método de pago</label>
    <select name="metodo" class="form-select" required>
        {% set metodos = ["tarjeta", "transferencia", "mercado_pago", "paypal"] %}
        {% for m in metodos %}
            <option value="{{ m }}"
                {% if pago and pago.metodo == m %}selected{% endif %}>
                {{ m|capitalize }}
            </option>
        {% endfor %}
    </select>

    <!-- Estado -->
    <label class="mt-3">Estado</label>
    <select name="estado" class="form-select" required>
        {% set estados = ["pendiente", "procesando", "pagado", "rechazado"] %}
        {% for e in estados %}
            <option value="{{ e }}"
                {% if pago and pago.estado == e %}selected{% endif %}>
                {{ e|capitalize }}
            </option>
        {% endfor %}
    </select>

    <!-- Monto -->
    <label class="mt-3">Monto</label>
    <input type="number" step="0.01" name="monto" class="form-control"
           value="{{ pago.monto if pago else '' }}" required>

    <button class="btn btn-primary mt-3" type="submit">
        {{ "Actualizar" if pago else "Guardar" }}
    </button>

</form>

{% endblock %}
